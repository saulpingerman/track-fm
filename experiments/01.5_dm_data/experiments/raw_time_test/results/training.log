
Experiment: raw_time_test
Output directory: /home/ec2-user/trackfm-toy studies/experiments/01.5_dm_data/experiments/raw_time_test
  Checkpoints: /home/ec2-user/trackfm-toy studies/experiments/01.5_dm_data/experiments/raw_time_test/checkpoints
  Results: /home/ec2-user/trackfm-toy studies/experiments/01.5_dm_data/experiments/raw_time_test/results
  Log file: /home/ec2-user/trackfm-toy studies/experiments/01.5_dm_data/experiments/raw_time_test/results/training.log

Configuration:
  data_path: /mnt/fsx/data
  catalog_path: /mnt/fsx/data/track_catalog.parquet
  synthetic_data_path: ./data
  use_synthetic: True
  no_velocity_features: True
  use_raw_time: True
  min_track_length: 528
  max_seq_len: 128
  min_sog: 3.0
  d_model: 128
  nhead: 8
  num_layers: 4
  dim_feedforward: 512
  dropout: 0.1
  grid_size: 64
  num_freqs: 12
  grid_range: 0.3
  max_horizon: 400
  num_horizon_samples: 40
  batch_size: 2000
  learning_rate: 0.0003
  weight_decay: 1e-05
  num_epochs: 5
  warmup_steps: 20
  val_every_n_batches: 20
  val_max_batches: 10
  sigma: 0.003
  dr_sigma: 0.05
  early_stop_patience: 4
  early_stop_min_delta: 0.01
  use_amp: True
  num_workers: 0
  pin_memory: True
  gradient_accumulation: 1
  lat_mean: 30.0
  lat_std: 1.5
  lon_mean: -70.0
  lon_std: 1.8
  sog_max: 30.0
  dt_max: 300.0

======================================================================
LOADING DATA
======================================================================
Loading synthetic data...
  Loading train data...
    Loaded 5775 train tracks
  Loading validation data...
    Loaded 576 val tracks
  Total train positions: 8,560,754
  Total val positions: 853,075

Creating datasets...
  Created 175,221 training samples from 5775 tracks
  Created 17,459 training samples from 576 tracks
  Train batches: 88
  Val batches: 18

======================================================================
CREATING MODEL
======================================================================
  Parameters: 1,004,514
  Architecture: d_model=128, nhead=8, num_layers=4, dim_ff=512

======================================================================
TRAINING
======================================================================

Initial validation (before training)...
  Model (untrained): 10.5177
  Random Model:      11.4983
  Dead Reckoning:    4.6256
  Last Position:     12.0449

  >>> VALIDATION at step 1 (batch 1):
      Train Loss:     10.3651
      ---
      Model:          10.5177  (vs DR: -127.4%, vs LP: +12.7%)
      Dead Reckoning: 4.6256
      Last Position:  12.0449
      Random Model:   11.4983

      Saved checkpoint: checkpoint_step_1.pt
      New best model!

  >>> VALIDATION at step 3 (batch 3):
      Train Loss:     10.3173
      ---
      Model:          9.8743  (vs DR: -113.5%, vs LP: +18.0%)
      Dead Reckoning: 4.6256
      Last Position:  12.0449
      Random Model:   11.4983

      Saved checkpoint: checkpoint_step_3.pt
      New best model!

  >>> VALIDATION at step 7 (batch 7):
      Train Loss:     9.3176
      ---
      Model:          8.2153  (vs DR: -77.6%, vs LP: +31.8%)
      Dead Reckoning: 4.6256
      Last Position:  12.0449
      Random Model:   11.4983

      Saved checkpoint: checkpoint_step_7.pt
      New best model!

  >>> VALIDATION at step 15 (batch 15):
      Train Loss:     7.6378
      ---
      Model:          6.8726  (vs DR: -48.6%, vs LP: +42.9%)
      Dead Reckoning: 4.6256
      Last Position:  12.0449
      Random Model:   11.4983

      Saved checkpoint: checkpoint_step_15.pt
      New best model!

  >>> VALIDATION at step 31 (batch 31):
      Train Loss:     6.5818
      ---
      Model:          6.0162  (vs DR: -30.1%, vs LP: +50.1%)
      Dead Reckoning: 4.6256
      Last Position:  12.0449
      Random Model:   11.4983

      Saved checkpoint: checkpoint_step_31.pt
      New best model!

  >>> VALIDATION at step 63 (batch 63):
      Train Loss:     6.0242
      ---
      Model:          5.7262  (vs DR: -23.8%, vs LP: +52.5%)
      Dead Reckoning: 4.6256
      Last Position:  12.0449
      Random Model:   11.4983

      Saved checkpoint: checkpoint_step_63.pt
      New best model!
Epoch 1/5 complete, Time=51.7s

  >>> VALIDATION at step 127 (batch 127):
      Train Loss:     5.6348
      ---
      Model:          5.3092  (vs DR: -14.8%, vs LP: +55.9%)
      Dead Reckoning: 4.6256
      Last Position:  12.0449
      Random Model:   11.4983

      Saved checkpoint: checkpoint_step_127.pt
      New best model!
Epoch 2/5 complete, Time=37.0s

  >>> VALIDATION at step 215 (batch 215):
      Train Loss:     5.2611
      ---
      Model:          4.9061  (vs DR: -6.1%, vs LP: +59.3%)
      Dead Reckoning: 4.6256
      Last Position:  12.0449
      Random Model:   11.4983

      Saved checkpoint: checkpoint_step_215.pt
      New best model!
Epoch 3/5 complete, Time=37.0s

  >>> VALIDATION at step 303 (batch 303):
      Train Loss:     4.4981
      ---
      Model:          3.9157  (vs DR: +15.3%, vs LP: +67.5%)
      Dead Reckoning: 4.6256
      Last Position:  12.0449
      Random Model:   11.4983

      Saved checkpoint: checkpoint_step_303.pt
      New best model!
Epoch 4/5 complete, Time=36.9s

  >>> VALIDATION at step 391 (batch 391):
      Train Loss:     3.7757
      ---
      Model:          3.5708  (vs DR: +22.8%, vs LP: +70.4%)
      Dead Reckoning: 4.6256
      Last Position:  12.0449
      Random Model:   11.4983

      Saved checkpoint: checkpoint_step_391.pt
      New best model!
Epoch 5/5 complete, Time=36.9s

Final validation...

  FINAL RESULTS:
  Model:          3.2712  (vs DR: +29.3%, vs LP: +72.8%)
  Dead Reckoning: 4.6256
  Last Position:  12.0449
  Random Model:   11.4983

======================================================================
EVALUATION
======================================================================
  horizon_100_error_deg: 0.0121
  horizon_100_error_km: 1.3478
  horizon_10_error_deg: 0.0018
  horizon_10_error_km: 0.1978
  horizon_1_error_deg: 0.0044
  horizon_1_error_km: 0.4867
  horizon_200_error_deg: 0.0698
  horizon_200_error_km: 7.7533
  horizon_400_error_deg: 0.3082
  horizon_400_error_km: 34.2155
  horizon_50_error_deg: 0.0060
  horizon_50_error_km: 0.6711

======================================================================
SAVING RESULTS
======================================================================

  Results saved to: /home/ec2-user/trackfm-toy studies/experiments/01.5_dm_data/experiments/raw_time_test
    - Checkpoints: /home/ec2-user/trackfm-toy studies/experiments/01.5_dm_data/experiments/raw_time_test/checkpoints
    - Results: /home/ec2-user/trackfm-toy studies/experiments/01.5_dm_data/experiments/raw_time_test/results
======================================================================
DONE
======================================================================
